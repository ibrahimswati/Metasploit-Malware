# Metasploit-Malware

Used msfvenom to inject a meterpreter reverse payload into a putty executable file, local host is set to my Kali address, and platform selected is Windows x86 64. Architecture is also x64. Couldn’t use shakita_ga_nai encoding because it requires x86 architecture and when I tried encoding it with x86 it didn’t work.

<img src="https://github.com/ibrahimswati/Metasploit-Malware/blob/main/malware.png">

It didn’t work as expected because every time I open the putty.exe it crashed and the meterpreter session is not created. The only time it started the handler was when I didn’t encode the payload as shakita_ga_nai doesn’t support x86.

<img src="https://github.com/ibrahimswati/Metasploit-Malware/blob/main/venom.png">

We can use dependency walker to analyze this malware and look at what dll’s it will call as it might help us determine what the malware does. We can also analyze using the size of the known executable.

On the right we can see the original putty.exe and on the left we can see puttyXABC.exe. puttyXABC.exe is our executable file with the payload and we can tell that with dependency walker that puttyXABC.exe makes a call for KERNEL32.dll and putty.exe doesn’t. This proves that the malware is present. We can also analyze using the size of known executables files such as putty. When we inject the payload and encode it 3 times it increases the size of the file which can also tell us that it has some kind of malware.

<img src="https://github.com/ibrahimswati/Metasploit-Malware/blob/main/dllmalware.png">
